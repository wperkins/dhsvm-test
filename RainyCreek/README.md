# Rainy Creek Basin

*This is NOT a DHSVM tutorial*. 

Rainy Creek is a small tributary to the Wenatchee River in western
Washington, USA.  This case was used as a DHSVM tutorial and the
original is available [](here).  It is regularly used as a sanity test
when DHSVM changes are made. Only minor modifications to the original
configuration is necessary to make this case work with modern DHSVM.

## Set up

  * Modify `arcinfo/rainy30/makebin.sh` (binary format) or
    `arcinfo/rainy30/makenc.sh` (NetCDF format) to point
    the appropriate DHSVM and/or [https://gdal.org/](GDAL) programs.
    
  * Run `makebin.sh` or `makennc.sh` to generate the input maps.
    
  * Generate initial an initial state for `09.01.1991.03.00.00` in
    `modelstate/` by using the `MakeModelStateBin` or
    `MakeModelStateNetCDF` program.  For example,
    
    `MakeModelStateNetCDF InitialState.txt 90 394455.344 769092.750`
    
### MASS1 Configuration ###

The MASS1 configuration is in `mass1`. The original was generated
using `channel_mass1` and has been changed minimally, if at all.
Generate a MASS1 channel state file by running `mass1_new` in
`mass1`. The file `hotstart.dat` will be generated. Place it in the
`modelstate` directory with an appropriate name, e.g.,

    `cp hotstart.dat ../modelstate/MASS1.State.09.01.1991.03.00.00`
    
## Running the Case

The simulation consists of overlapping warm-up and a run periods.  

  * In the same directory as `configfiles` and `modelstate` make a
    directory called `output`.

  * With `configfiles/` as the working directory, run the warm up, e.g.,
    period:
    
    `DHSVM INPUT.rainycreek`
    
    Simulation results will be produced in the `output` directory.  

  * Copy the generated model state files (`*05.04.1992.03.00.00*`)
    from `output` to `modelstate`. 
    
  * With `configfiles/` as the working directory, run the simulation
    period, e.g., 
    
    `DHSVM INPUT.rainycreek.restart`

## Sample Output

Two sets of "baseline" output files are included.  These only cover
the run period.  These were generated on a RHEL7 desktop system. 

  * `output.serial` was generated by serial DHSVM (`master` branch,
    commit `e4990f8`)
    
  * `output.4` was generated by parallel DHSVM (`parallel` branch,
    commit `aaa5eb5`) using 4 processors.
